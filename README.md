# Новое русское вино

Сайт магазина авторского вина "Новое русское вино".

# Проект "Wine Explorer"


## Описание проекта

Проект "Wine Explorer" представляет собой скрипт на языке программирования Python, который позволяет исследовать различные вина и рассчитывать ваш возраст, основываясь на годе вашего рождения. Результаты представляются в виде интерактивной HTML-страницы, которую можно просматривать в браузере.

## Основные особенности

- Расчет возраста магазина на основе года создания и текущего года.
- Загрузка данных о винах из файла Excel и их структурирование для дальнейшего анализа.
- Создание HTML-страницы с информацией о возрасте и винах для просмотра.
- Запуск встроенного HTTP-сервера для предоставления доступа к результатам.

## Установка и настройка

1. Клонируйте данный репозиторий на ваше локальное устройство:

2. Убедитесь, что у вас установлен Python (рекомендуемая версия Python 3.x).

3. Установите необходимые зависимости, выполнив команду:

```bash
pip install -r requirements.txt
```

4. Создайте файл `.env` в корневой папке проекта и добавьте в него переменные окружения:

```plaintext
EXCEL_FILE_PATH=path/to/your/excel/file.xlsx
```

5. Укажите путь к файлу в переменной окружения `EXCEL_FILE_PATH`.

## Запуск

Выполните следующую команду для запуска проекта:

```bash
python main.py
```

После выполнения скрипта, будет создана HTML-страница с именем `index.html` в корневой папке проекта. Чтобы открыть страницу с результатами, перейдите по ссылке: [http://localhost:8000/index.html](http://localhost:8000/index.html).

## Описание функций

#### calculate_years_passed(starting_year)

Рассчитывает возраст магазина на основе указанного года основания.

Параметры:
- `starting_year`: Год основания (целое число).

Возвращает:
- Строку с возрастом магазина и соответствующим склонением, например, "30 лет" или "25 года".

#### load_excel_data(file_path)

Загружает данные из файла Excel и структурирует их в словарь по категориям вин.

Параметры:
- `file_path`: Путь к файлу Excel с данными о винах (строка).

Возвращает:
- Словарь с данными о винах, сгруппированными по категориям.

#### render_template(data)

Рендерит HTML-страницу, используя данные о возрасте и винах.

Параметры:
- `data`: Словарь с данными о возрасте и винах.

Возвращает:
- Строку с HTML-кодом с результатами исследования.

#### save_to_html(html_content, output_file)

Сохраняет HTML-страницу в файл.

Параметры:
- `html_content`: Строка с HTML-кодом для сохранения.
- `output_file`: Путь к файлу, в который следует сохранить HTML-страницу.

#### start_server()

Запускает HTTP-сервер для предоставления доступа к HTML-странице с результатами исследования.
## Структура проекта

```
wine-explorer/
│   main.py
│   template.html
│   wine.xlsx
│   .env
│   README.md
│   requirements.txt
```

## Зависимости

- Python 3.x
- Библиотеки: jinja2, pandas, dotenv


## Автор

Дмитрий Мочалов